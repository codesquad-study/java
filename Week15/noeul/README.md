## λ“¤μ–΄κ°€κΈ°μ „μ—

> JAVAμ Methodλ” First Class Citizen(1κΈ‰ κ°μ²΄)κ°€ μ•„λ‹λ‹¤.

<br>

1. νλΌλ―Έν„°λ΅ μ „λ‹¬ ν•  μ μλ‹¤. (**X**)

```java
public String getName(){
			 ...
}

findByName(getName); // getName()μΌλ΅ returnμ΄ μ•„λ‹ λ©”μ†λ“ μμ²΄
```

2. returnκ°’μΌλ΅ methodλ¥Ό λ°›μ„ μ μλ‹¤. (**X**)

```java
public doSomething(){
	return getName; // λ©”μ†λ“ μμ²΄ 
}
```

3. λ³€μλ‚ λ°μ΄ν„° κµ¬μ΅°μ•μ— λ‹΄μ„ μ μλ‹¤. (**X**)

```java
List<> list = Arrays.asList(getName) // λ©”μ†λ“ μμ²΄
```



> JAVA 8 μ΄ν›„ λ¶€ν„° ν•¨μν• ν”„λ΅κ·Έλλ°μ„ μ§€μ›ν•κ² λ¨.
> Functional Featureλ¥Ό μ¶”κ°€ν•κ² λ μ΄μ λ” First Class Functionμ„ κ°€μ§€κΈ° μ„ν•¨.



##### μλ°”μ—μ„ First Class Function λ¥Ό ν‘ν„ν•κΈ° μ„ν• λ°©λ²•

- Anonymous Method (μµλ… λ©”μ†λ“)
- Lambda Expression `method(i->i+1)`



<br>



# λλ‹¤μ‹(=μµλ…ν•¨μ)

- ν•¨μν• ν”„λ΅κ·Έλλ° κΈ°λ²•(`y=f(x)`)
  - λ©”μ„λ“λ¥Ό ν•λ‚μ μ‹(expression)μΌλ΅ ν‘ν„ν• κ²ƒ

- μƒν™©μ— λ”°λΌ λ‹¤λ¥΄μ§€λ§, μ½”λ“κ°€ λ§¤μ° `κ°„κ²°`ν•΄μ§„λ‹¤.
- μ»¬λ ‰μ… μ”μ†(λ€μ©λ‰ λ°μ΄ν„°)λ¥Ό `ν•„ν„°λ§` λλ” `λ§µν•‘` ν•΄μ„ μ‰½κ² `μ§‘κ³„` ν•  μ μλ‹¤.

- λ°μ΄ν„°λ¥Ό λ§¤κ°κ°’μΌλ΅ μ „λ‹¬ν•κ³  κ²°κ³Όλ¥Ό λ°›λ” μ½”λ“λ΅ κµ¬μ„±

- `λλ‹¤μ‹`μ€ `ν•λ‚μ λ©”μ†λ“`λ¥Ό μ •μν•¨.

- `λλ‹¤μ‹`μ€ μµλ… ν΄λμ¤μ™€ λ™μ‘λ°©μ‹μ΄ λ‹¤λ¥΄λ‹¤.

  - μµλ… ν΄λμ¤λ” λ§¤ λ² μƒ ν΄λμ¤λ¥Ό μ •μν•κ³  κ°μ²΄λ¥Ό μƒμ„±ν•λ” λ¬Έμ μ μ΄μμ.

  - λ”°λΌμ„, λλ‹¤λ” μ„ λ¬Έμ μ μ„ ν•΄κ²°ν•λ” λ°©μ‹μΌλ΅ κµ¬ν„λ¨.

  - λλ‹¤μ‹μ€ μ»΄νμΌ νƒ€μ„μ— ν΄λμ¤κ°€ μ •μλμ§€ μ•κ³ , `λ°νƒ€μ„`μ—` JVM`μ΄ ν•λ„λ΅ λ– λ„κΈ΄λ‹¤κ³  ν•¨.

  - π’« μμ„Έν• λ‚΄μ©: https://dreamchaser3.tistory.com/5

    

## λλ‹¤μ‹ μ‚¬μ©λ²•

- π”† μλ°”λ” `λλ‹¤μ‹`μ„ `ν•¨μν• μΈν„°νμ΄μ¤`μ `μµλ… κµ¬ν„ κ°μ²΄`λ΅ μ·¨κΈ‰
  - `ν•¨μν• μΈν„°νμ΄μ¤`λ” λ©”μ†λ“ ν• κ°λ§ κ°€μ§€κ³  μλ” μΈν„°νμ΄μ¤μ ν•νƒλ¥Ό λ§ν•λ‹¤.
  - μ¦‰, μ•„λ¬΄ ν΄λμ¤, μΈν„°νμ΄μ¤ λ“±μ— λλ‹¤μ‹μ„ μ‚¬μ©ν•  μ μ—†λ‹¤.
- `μµλ… ν•¨μ`λ‹µκ² `λ©”μ„λ“`μ—μ„ `μ΄λ¦„`κ³Ό `λ°ν™νƒ€μ…`μ„ μ κ±°ν•κ³  λ§¤κ°λ³€μ μ„ μ–Έλ¶€μ™€ λΈν†µ`{}` μ‚¬μ΄μ— `->` λ¥Ό μ¶”κ°€

```java
λ°ν™νƒ€μ… λ©”μ„λ“μ΄λ¦„(λ§¤κ°λ³€μ μ„ μ–Έ){...}
```

λλ‹¤μ‹ λ³€ν™ π”½

```
(λ§¤κ°λ³€μ μ„ μ–Έ) -> {...}

( int a ) -> { System.out.println(a); }
```



#### λλ‹¤μ‹μ μ½”λ“ κ°„κ²°μ„±

```java

// 1 : 2 : 3 : 4 : 5 : 6 : 7 : 8 : 9 : 10 μ„ λ§λ“μ‹μ¤.
// <μ΅°κ±΄> λ§μ§€λ§‰ λ¬Έμμ—΄ 10 λ’¤μ—λ” ":" λ¬Έμκ°€ μ—†μ–΄μ•Ό ν•¨.

// case 1
// λ„λ¬΄ λ³µμ΅ν•¨.
final String separtor = " : ";
for(Integer number : numbers){
	StringBuilder.append(number).append(separator);
}
final int stringLength = strignBuilder.length();
if(stringLength > 0){
	stringBuilder.delete(stringLength - separator.length(), stringLength);
}
System.out.println(stringBuilder.toString());


// case 2
final String result = numbers.stream()
    						 .map(String::valueof)
                             .collect(joining(" : "));

```



##### λλ‹¤μ‹ μμ‹)

- `μ–΄λ–¤ μΈν„°νμ΄μ¤`λ¥Ό κµ¬ν„ν• μ§€λ” λ€μ…λλ” μΈν„°νμ΄μ¤μ— λ‹¬λ ¤μλ‹¤.
- λλ‹¤μ‹μ€ μµλ… ν΄λμ¤μ κ°μ²΄μ™€ κ±°μ `λ™λ“±`ν•λ‹¤.

```java
# λλ‹¤μ‹

Runnable runnable = ()->{...};  

# μµλ… ν΄λμ¤ 

Runnable runnable = new Runnable(){
	public void run() {...}	 // ν•¨μν• μΈν„°νμ΄μ¤(Runnable)μ€ λ©”μ†λ“ ν• κ°
}
```



#### λλ‹¤μ‹ μ•½μ‹ νƒ€μ…

- λ§¤κ° νƒ€μ…μ€ λ°νƒ€μ„μ‹μ— λ€μ…κ°’μ— λ”°λΌ μλ™μΌλ΅ μΈμ‹ν•κΈ° λ•λ¬Έμ— μƒλµ κ°€λ¥

  ```java
  (a) -> {System.out.println(a);}
  ```

- λ§¤κ°λ³€μκ°€ `μ—†λ‹¤λ©΄` κ΄„νΈ `()` λ¥Ό μƒλµν•  μ μ—†μ

  ```
  () -> {μ‹¤ν–‰λ¬Έ; ...}
  ```

- ν•λ‚μ λ§¤κ°λ³€μλ§ μμ„ κ²½μ°μ—λ”

  ```
  a -> {System.out.println(a);}
  ```

- λ¦¬ν„΄κ°’μ΄ μλ” κ²½μ°, `return` λ¬Έ μ‚¬μ©

  ```
  (x,y) -> { return x+y; };
  ```

- ν•λ‚μ μ‹¤ν–‰λ¬Έλ§ μλ‹¤λ©΄ μ¤‘κ΄„νΈ `{}` μƒλµ κ°€λ¥
  ```
  a -> System.out.println(a)
  ```

- μ¤‘κ΄„νΈ `{}`μ— `return`λ¬Έλ§ μμ„ κ²½μ°, `μ¤‘κ΄„νΈ`μ™€ `return` μƒλµ κ°€λ¥

  ```
  (x,y) -> x+y
  ```

  

## ν•¨μν• μΈν„°νμ΄μ¤

- ν•λ‚μ μ¶”μƒ λ©”μ†λ“λ§ μ„ μ–Έλ μΈν„°νμ΄μ¤λ¥Ό λ§ν•¨.

- λ°λ©΄μ—, `static` λ©”μ„λ“μ™€ `default` λ©”μ„λ“μ κ°μμ—λ” μ μ•½μ΄ μ—†μ.

- `@FunctionalInterface`

  - ν•λ‚μ μ¶”μƒ λ©”μ†λ“λ§μ„ κ°€μ§€λ”μ§€ μ»΄νμΌλ¬κ°€ μ²΄ν¬ν•λ„λ΅ ν•¨.

  - λ‘ κ° μ΄μƒμ μ¶”μƒ λ©”μ†λ“κ°€ μ„ μ–Έλμ–΄ μμΌλ©΄ μ»΄νμΌ μ¤λ¥κ°€ λ°μƒ

  - ν•¨μν• μΈν„°νμ΄μ¤μ— κΌ­ λ¶™μ—¬ μ¤μ•Όν•λ” κ²ƒμ€ μ•„λ‹κ³ , μ‹¤μλ¥Ό μ¤„μ΄κΈ° μ„ν•΄ μ‚¬μ©

    

```java
@FunctionalInterface
public interface MyFunctionalInterface{
	public int method(int x, int y);
}

public static void main(String[] args){
	MyFunctionalInterface fi;

	fi = (x, y) -> sum(x, y);

	System.out.println(fi.method(2,5));
}

public static int sum(int x, int y){
	return x+y;
}

------
output

> 7
```



## κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤

- μλ°”μ—μ„ κΈ°λ³Έμ μΌλ΅ μ κ³µν•λ” ν•¨μν• μΈν„°νμ΄μ¤

>  Function`κ³Ό `Operator`λ” ν° μ°¨μ΄κ°€ μ—†μ–΄ λ³΄μ΄λ”λ° λ¬΄μ¨ μ©λ„λ΅ κµ¬λ¶„ν• κΉβ“β“

##### `Supplier` ν•¨μν• μΈν„°νμ΄μ¤λ¥

- λ§¤κ°κ°’μ€ μ—†κ³  λ¦¬ν„΄κ°’λ§ μλ” μ¶”μƒ λ©”μ†λ“λ¥Ό κ°€μ§€κ³  μμ.

##### `Consumer` ν•¨μν• μΈν„°νμ΄μ¤λ¥

- λ°μ΄ν„°λ¥Ό μ†λΉ„λ§ν•κ³  κΈ°λ¥ μ κ³µ
- λ§¤κ°κ°’λ§ μκ³  λ¦¬ν„΄κ°’μ΄ μ—†λ” μ¶”μƒ λ©”μ†λ“λ¥Ό κ°€μ§€κ³  μμ.

##### `Function` ν•¨μν• μΈν„°νμ΄μ¤λ¥

- λ§¤κ°κ°’κ³Ό λ¦¬ν„΄κ°’ λ¨λ‘ μλ” μ¶”μƒ λ©”μ†λ“λ¥Ό κ°€μ§€κ³  μλ‹¤.
- μ£Όλ΅ `λ§¤κ°κ°’`μ„ `λ¦¬ν„΄κ°’`μΌλ΅ `λ§¤ν•‘(νƒ€μ…λ³€ν™)`ν•  κ²½μ°μ— μ‚¬μ©

##### `Operator` ν•¨μν• μΈν„°νμ΄μ¤λ¥

- λ§¤κ°κ°’κ³Ό λ¦¬ν„΄κ°’μ΄ λ¨λ‘ μλ” μ¶”μƒ λ©”μ†λ“λ¥Ό κ°€μ§€κ³  μλ‹¤.
- μ£Όλ΅ `λ§¤κ°κ°’`μ„ `μ—°μ‚°`ν•κ³  κ·Έ `κ²°κ³Ό`λ¥Ό `λ¦¬ν„΄`ν•  κ²½μ°μ— μ‚¬μ©

##### `Predicate` ν•¨μν• μΈν„°νμ΄μ¤λ¥

- λ§¤κ°κ°’μ„ μ΅°μ‚¬ν•΄μ„ true λλ” falseλ¥Ό λ¦¬ν„΄ν•  λ• μ‚¬μ©

<br>

- https://docs.oracle.com/javase/8/docs/api/java/util/function/package-summary.html



## Closure

```java
void method()
{
	int i = 100;

	someMethod(x->x*2+i)  // x: νλΌλ―Έν„°,  i: non-local variable
}
```

- i (== non-local variable)λ” `Lambda Expression` ν•¨μ `μ™Έλ¶€`μ— μ΅΄μ¬ν•¨ 

- μµλ… ν•¨μκ°€ non-local variableμ— μ ‘κ·Όμ„ ν•λ©΄ μ΄λ° ν•¨μλ¥Ό `Closure`λΌκ³  λ¶€λ¦„

  

### ClosureλΌκ³  λ¶€λ¥΄λ” μ΄μ 

- λλ‹¤ ν•¨μ μμ²΄ μ¤μ½”ν”„λ¥Ό μ™Έλ¶€λ΅ ν™•μ¥ν•΄μ„ `Close Over` ν•λ‹¤ν•΄μ„ Closure



## Effectively Final 

- λλ‹¤μ‹μ—μ„ μ‚¬μ©ν•λ” μ™Έλ¶€ λ΅μ»¬ λ³€μλ” `final` νΉμ„±μ„ κ°–λ”λ‹¤.

- effectively final λ³€μλ” final ν‚¤μ›λ“κ°€ λ¶™μ–΄μμ§€ μ•μ§€λ§ fianl ν‚¤μ›λ“λ¥Ό λ¶™μΈ κ²ƒκ³Ό λ™μΌν•κ² μ»΄νμΌμ—μ„ μ²λ¦¬

- λ…μ‹μ μΌλ΅ finalμ„ λ¶™μ΄μ§€ μ•λ”λΌλ„, λ¬µμ‹μ μΌλ΅ finalμ΄ μ μ©λ¨.

- μ•„λ μμ μ—μ„ `int number`λ” `final`μ΄ μ•„λ‹μ§€λ§ μμ •ν•κ² λ  κ²½μ° μ—λ¬κ°€ λ°μƒν•¨.

  - λ¬µμ‹μ μΌλ΅ finalμ΄ μ μ©λ κ²ƒμ„, μ΄κ²ƒμ„ `Effectively Final`μ΄λΌκ³  λ¶€λ¥Έλ‹¤.

- `Effectively Final`μΈ μ΄μ λ” **λ©€ν‹° μ¤λ λ”©**μ—μ„ `Race Condition`μ΄ λ°μƒν•  μ μμ–΄μ„ κΈμ§€ μ‹ν‚¨ κ²ƒ

  

```java
public class ClosureExample {

    public static void main(String[] args) {
        int number = 100;  // final μ΄ λ¬µμ‹μ μΌλ΅ μ μ©λ¨.
        
        final Runnable runnable = new Runnable() { //m μµλ…ν•¨μ
            @Override
            public void run() {
				//number = 99;   // β›” μ—λ¬ λ°μƒ!
                System.out.println(number);
            }
        };
        runnable.run();
        
        Runnable runnable2 = ()-> System.out.println(number);  //m λλ‹¤ ν‘ν„μ‹
        runnable2.run();

    }

}
```



> - μ™ μ΄λ° μ μ•½μ΅°κ±΄μ΄ μλ”κ±ΈκΉ?
>   - JVM λ©”λ¨λ¦¬ κµ¬μ΅°λ¥Ό λμ§μ–΄λ³΄μ.
>     - μ§€μ—­ λ³€μλ” **μ“°λ λ“λΌλ¦¬ κ³µμ κ°€ μ• λλ‹¤.**
>     - JVMμ—μ„ μΈμ¤ν„΄μ¤ λ³€μλ” ν™ μμ—­μ— μƒμ„±λλ‹¤.
>     - μΈμ¤ν„΄μ¤ λ³€μλ” **μ“°λ λ“λΌλ¦¬ κ³µμ κ°€ κ°€λ¥ν•λ‹¤**
> - κ²°λ΅ μ μΌλ΅
>   - μ§€μ—­ λ³€μκ°€ μ¤νƒμ— μ €μ¥λκΈ° λ•λ¬Έμ— λλ‹¤μ‹μ—μ„ κ°’μ„ λ°”λ΅ μ°Έμ΅°ν•λ” κ²ƒμ— μ μ•½μ΄ μμ–΄ λ³µμ‚¬λ κ°’μ„ μ‚¬μ©ν•λ”λ° μ΄λ• λ©€ν‹° μ“°λ λ“ ν™κ²½μ—μ„ λ³€κ²½μ΄ λλ©΄ λ™μ‹μ„±μ— λ€ν• μ΄μλ¥Ό λ€μ‘ν•κΈ°κ°€ νλ“¤λ‹¤.
>
> - μ¶μ²: https://sujl95.tistory.com/76



## Variable Capture

- μλ°”μ λλ‹¤ ν‘ν„μ‹μ€ `μ™Έλ¶€ λ³€μ(free variable)` λ¥Ό μ°Έμ΅° ν•μ§€ μ•κ³ , μ™Έλ¶€ λ³€μμ `value`λ¥Ό μΊ΅μ³ν•λ‹¤.
- μ΄λ¬ν• μ΄μ (Race Conditions ...λ“±)λ΅ λ³€μμ κ°’μ΄ λ°”λ€λ©΄ μ•λκ³  `final` or `Effectively final` μ΄μ–΄μ•Όν•¨.



## λ©”μ†λ“ μ°Έμ΅°

```java
Function<String, Integer> f = (String s) -> Integer.parseInt(s);

Function<String, Integer> f = Integer::parseInt;  // λ©”μ„λ“ μ°Έμ΅°
```



### μƒμ„±μμ λ©”μ„λ“ μ°Έμ΅°

```java
Supplier<MyClass> s = () -> new MyClass();  // λλ‹¤μ‹
Supplier<MyClass> s = MyClass::new;    // λ©”μ„λ“ μ°Έμ΅°
```



- ν•λ‚μ λ©”μ„λ“λ§ νΈμ¶ν•λ” λλ‹¤μ‹μ€ `ν΄λμ¤μ΄λ¦„::λ©”μ„λ“μ΄λ¦„` λλ” `μ°Έμ΅°λ³€μ::λ©”μ„λ“μ΄λ¦„` μΌλ΅ λ°”κΏ€ μ μλ‹¤.



----



### Reference.

- https://codechacha.com/ko/java8-functional-interface/

- https://github.com/Kevin-Lee/modern-java-untold
- https://sujl95.tistory.com/76
- μ΄κ²ƒμ΄ μλ°”λ‹¤
- μλ°”μ μ •μ„